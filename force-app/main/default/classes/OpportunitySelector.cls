public with sharing class OpportunitySelector {
    
    public static List<Opportunity> selectByIdAndStageName (Set<Id> oppIds, Set<String> stageNames) {
        return [
            SELECT 
                Id, 
                StageName 
            FROM Opportunity WHERE Id = :oppIds AND StageName IN:stageNames
        ];
    }

    public static List<Opportunity> selectByOpportunityId (Set<Id> opportunityIds) {

        return [ SELECT AccountId, 
                        Agencia__c,
                        Amount,
                        Budget_Confirmed__c,
                        CelebridadesLiberadas__c,
                        Cidade__c,
                        CloseDate,
                        CNPJ__c,
                        CnpjNumeros__c,
                        ContatoComprador__c,
                        ContatoFinanceiro__c,
                        ContatoJuridico__c,
                        ContatosMarketing__c,
                        ContractId,
                        CotacaoSincronizada__c,
                        Cota_es_na_oportunidade__c,
                        CreatedDate,
                        CreatedById,
                        CreatedDate__c,
                        PaymentLink_sendingDate__c,
                        LastModifiedDate__c,
                        EndOfContractDate__c, 
                        ContractStartDate__c,
                        Data_mais_recente_de_proposta__c,
                        ProposalSubmissionDates__c,
                        CompletedMeetingDates__c,
                        OpportunityEntryDates_byStage__c,
                        Desconto_total__c, 
                        Description,
                        Discovery_Completed__c,
                        E_mail__c,
                        Emaill__c,
                        Company__c,
                        ExpectedRevenue,
                        ExternalOpportunityID__c, 
                        IsAceleraiAgenciasMembership__c,
                        ForecastCategoryName,
                        Forma_de_Pagamento__c,
                        Formulario_Preenchido__c,
                        Funnel__c,
                        Hor_rio_m_ximo_para_contato__c,
                        CompanyAge__c, 
                        WhatsYourInstagram__c,
                        MonthlyInvestmentMedia_Content__c,
                        Ja_foi_anunciante__c,
                        LastModifiedById,
                        Lead__c,
                        LeadSource,
                        LetraScoreFinal__c,
                        LetraLeadScore__c, 
                        Link_Oportunidade_SGC__c,
                        MediaChannelsUsed__c,
                        Loss_Reason__c,
                        Media__c,
                        SocialMedia_website__c,
                        NextStep,
                        AgencyName_NonSubscribed__c, 
                        AceleraiAgenciasSubscriberAgencyName__c,
                        ClientsObjectiveWithAcelerai__c,
                        Notes__c,
                        StateYourCompany__c,
                        RelatedOpportunity__c,
                        Name,
                        OwnerId,
                        Owner.Name,
                        RecordTypeId,
                        RecordType.DeveloperName, 
                        PartnerAccountId,
                        Pol_tica_Comercial__c,
                        HaveCurrentlyAgency__c,
                        CampaignStartIntention__c,
                        CloseDateEstimated__c,
                        Pricebook2Id,
                        CampaignId,
                        IsPrivate, 
                        Probability,
                        Proposta_v_lida__c,
                        WhatsYourRole__c,
                        QuandoPretendeAnunciar__c,
                        NumberEmployees__c,
                        SentProposalsCount__c,
                        Quantidade_de_propostas_enviadas__c, 
                        CompletedMeetingsCount__c,
                        Quantidade_de_Vendas__c,
                        TotalOpportunityQuantity,
                        Referencia_base_antiga__c,
                        ROI_Analysis_Completed__c,
                        Score__c,
                        Segmento__c, 
                        Soma_das_cota_es__c,
                        StageName,
                        SyncedQuoteId,
                        Telefone__c,
                        Telefone1__c,
                        Tipo_de_cliente__c,
                        SaleType__c,
                        Type,
                        updateSGC__c,
                        UsuarioConversao__c, 
                        UTM_Campaign__c,
                        UTM_Content__c,
                        UTM_Medium__c,
                        UTM_Source__c,
                        UTM_Term__c,
                        Valor_final_da_venda__c,
                        Valor_m_dio_cota_es__c,
                        Valor_Total_Neg_Fechada__c, 
                        ValueScoreFinal__c,
                        ValueLeadScore__c,
                        Veiculacao__c,
                        Vendedor_Varejo__c,
                        Fbclid__c,
                        Metalead_id__c,
                        Gclid__c
                    FROM Opportunity 
                    WHERE Id =: opportunityIds
                ];
    }

    public static List<Opportunity> selectByEmails(Set<String> leadEmails) {
        return [
            SELECT Id, Name, OwnerId, Owner.Email, Owner.Name, Owner.isActive, Emaill__c, StageName, Segmento__c, AccountId, 
                   Funnel__c, WhatsYourInstagram__c, CNPJ__c, Tipo_de_cliente__c, CreatedDate,
                   Ja_foi_anunciante__c, WhatsYourRole__c, QuandoPretendeAnunciar__c, Agencia__c,
                   NumberEmployees__c, MonthlyInvestmentMedia_Content__c, CompanyAge__c, 
                   HaveCurrentlyAgency__c, StateYourCompany__c, Cidade__c, lead__c, CampaignStartIntention__c, ClientsObjectiveWithAcelerai__c, Company__c, 
                   Referencia_base_antiga__c, Veiculacao__c, RelatedOpportunity__c, UTM_Campaign__c, UTM_Content__c, UTM_Medium__c, UTM_Source__c, UTM_Term__c
            FROM Opportunity 
            WHERE Emaill__c IN :leadEmails
            AND RecordType.Name = 'Varejo' 
            ORDER BY CreatedDate DESC];
    }

    public static List<Opportunity> selectOpportunityVendaRdByEmail(Set<String> leadEmails) {
        List<Account> accountsWithOnlyVendaRd = [
            SELECT Id 
            FROM Account 
            WHERE Id NOT IN (
                SELECT AccountId 
                FROM Opportunity 
                WHERE RecordType.Name != 'Venda rd'
            )
            AND Id IN (
                SELECT AccountId 
                FROM Opportunity 
                WHERE RecordType.Name = 'Venda rd'
            )
        ];

        List<Opportunity> opportunities = [
            SELECT
            Id, 
            AccountId, 
            Owner.Email, 
            Owner.Name, 
            Owner.isActive,
            Agencia__c,
            Amount,
            //BaseGanha__c,
            Budget_Confirmed__c,
            CelebridadesLiberadas__c,
            Cidade__c,
            CloseDate,
            CNPJ__c,
            CnpjNumeros__c,
            ContatoComprador__c,
            ContatoFinanceiro__c,
            ContatoJuridico__c,
            ContatosMarketing__c,
            ContractId,
            //CotacaoPagamentoFuturo__c,
            CotacaoSincronizada__c,
            //CotacaoVendaFutura__c,
            Cota_es_na_oportunidade__c,
            CreatedById,
            CreatedDate__c,
            PaymentLink_sendingDate__c,
            LastModifiedDate__c,
            EndOfContractDate__c, 
            ContractStartDate__c,
            Data_mais_recente_de_proposta__c,
            ProposalSubmissionDates__c,
            CompletedMeetingDates__c,
            OpportunityEntryDates_byStage__c,
            Desconto_total__c, 
            Description,
            Discovery_Completed__c,
            E_mail__c,
            Emaill__c,
            Company__c,
            //existenciaPropostaValida__c,
            ExpectedRevenue,
            ExternalOpportunityID__c, 
            IsAceleraiAgenciasMembership__c,
            ForecastCategoryName,
            Forma_de_Pagamento__c,
            Formulario_Preenchido__c,
            Funnel__c,
            Hor_rio_m_ximo_para_contato__c,
            CompanyAge__c, 
            WhatsYourInstagram__c,
            MonthlyInvestmentMedia_Content__c,
            Ja_foi_anunciante__c,
            LastModifiedById,
            Lead__c,
            LeadSource,
            LetraScoreFinal__c,
            LetraLeadScore__c, 
            Link_Oportunidade_SGC__c,
            MediaChannelsUsed__c,
            Loss_Reason__c,
            Media__c,
            SocialMedia_website__c,
            NextStep,
            AgencyName_NonSubscribed__c, 
            AceleraiAgenciasSubscriberAgencyName__c,
            ClientsObjectiveWithAcelerai__c,
            Notes__c,
            StateYourCompany__c,
            RelatedOpportunity__c,
            Name,
            OwnerId,
            RecordTypeId,
            RecordType.DeveloperName, 
            //IqScore,
            PartnerAccountId,
            Pol_tica_Comercial__c,
            HaveCurrentlyAgency__c,
            CampaignStartIntention__c,
            CloseDateEstimated__c,
            Pricebook2Id,
            CampaignId,
            IsPrivate, 
            Probability,
            Proposta_v_lida__c,
            WhatsYourRole__c,
            QuandoPretendeAnunciar__c,
            NumberEmployees__c,
            SentProposalsCount__c,
            Quantidade_de_propostas_enviadas__c, 
            CompletedMeetingsCount__c,
            Quantidade_de_Vendas__c,
            TotalOpportunityQuantity,
            Referencia_base_antiga__c,
            ROI_Analysis_Completed__c,
            Score__c,
            Segmento__c, 
            Soma_das_cota_es__c,
            StageName,
            SyncedQuoteId,
            Telefone__c,
            Telefone1__c,
            Tipo_de_cliente__c,
            SaleType__c,
            Type,
            updateSGC__c,
            UsuarioConversao__c, 
            UTM_Campaign__c,
            UTM_Content__c,
            UTM_Medium__c,
            UTM_Source__c,
            UTM_Term__c,
            Valor_final_da_venda__c,
            Valor_m_dio_cota_es__c,
            Valor_Total_Neg_Fechada__c, 
            ValueScoreFinal__c,
            ValueLeadScore__c,
            Veiculacao__c,
            Vendedor_Varejo__c 
            FROM Opportunity 
            WHERE RecordType.Name = 'Venda rd' 
            AND Emaill__c IN :leadEmails 
            AND AccountId IN :accountsWithOnlyVendaRd
            ORDER BY CreatedDate DESC LIMIT 1
        ];

        return opportunities;
    }

    public static List<Opportunity> selectOpportunityMetaIntegration(List<Id> opportunityIds){
        return [
            SELECT  CampaignStartIntention__c,
                    Cidade__c,
                    ClientsObjectiveWithAcelerai__c,
                    CloseDate,
                    CnpjNumeros__c,
                    CNPJ__c,
                    Company__c,
                    CompanyAge__c,
                    ContractStartDate__c,
                    Cota_es_na_oportunidade__c,
                    CotacaoSincronizada__c,
                    Data_mais_recente_de_proposta__c,
                    CreatedDate,
                    Emaill__c,
                    EndOfContractDate__c,
                    Funnel__c,
                    Gclid__C,
                    Fbclid__c,
                    Metalead_id__c,
                    Telefone__c,
                    HaveCurrentlyAgency__c,
                    Ja_foi_anunciante__c,
                    Loss_reason__c,
                    MonthlyInvestmentMedia_Content__c,
                    Name,
                    NumberEmployees__c,
                    Pol_tica_Comercial__c,
                    ProposalSubmissionDates__c,
                    Proposta_v_lida__c,
                    QuandoPretendeAnunciar__c,
                    Referencia_base_antiga__c,
                    SaleType__c,
                    StageName,
                    StateYourCompany__c,
                    Telefone1__c,
                    Tipo_de_cliente__c,
                    Utm_campaign__c,
                    Utm_source__c,
                    Utm_medium__c,
                    Utm_term__c,
                    Utm_content__c,
                    Valor_final_da_venda__c,
                    Valor_m_dio_cota_es__c,
                    Veiculacao__c,
                    WhatsYourInstagram__c,
                    WhatsYourRole__c,
                    Id,
                    AccountId,
                    ContactId,
                    ContatoComprador__c,
                    ContatoFinanceiro__c,
                    ContatosMarketing__c,
                    ContatoJuridico__c,
                    Lead__c,
                    RelatedOpportunity__c
                FROM Opportunity 
                WHERE Id IN :opportunityIds
            ];
    }


}